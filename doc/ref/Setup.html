<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>

  <title>PlotDevice Reference: Setup</title>
  <link charset="utf-8" href="../etc/manual.css" rel="stylesheet" type="text/css"/>

</head><body>
  <div class="link" id="nav">
    <h1><a href="../manual.html">Plot Device <span>Reference</span></a></h1>

    <ul class="siblings">
      <li>
        <h3 style="margin:0;">Setup</h3></li>
      <li><a href="Primitives.html">Primitives</a></li>
      <li><a href="Drawing.html">Drawing</a></li>
      <li><a href="Line+Color.html">Line &amp; Color</a></li>
      <li><a href="Typography.html">Typography</a></li>
      <li><a href="Utility.html">Utility</a></li>
    </ul>
  </div>

  <div class="article">
    <div class="commands">
      <a name="background()"></a>

      <div class="section">
        <h3>background()</h3>

        <div class="definition">
          <h2>Syntax</h2>

          <div class="row">
<pre>
<span class="nf">background</span>(r, g, b, a<span class="o">=</span><span class="mf">1.0</span>)
<span class="nf">background</span>(h, s, b, a<span class="o">=</span><span class="mf">1.0</span>)
<span class="nf">background</span>(c, m, y, k, a<span class="o">=</span><span class="mf">1.0</span>)
<span class="nf">background</span>(k, a<span class="o">=</span><span class="mf">1.0</span>)
<span class="nf">background</span>(<span class="nf">color</span>)
<span class="nf">background</span>(<span class="bp">None</span>)
</pre>
          </div>

          <h2>Description</h2>

          <div class="row">
            Sets the PDF background color. This command works exactly like the <a href="Line+Color.html#fill()">fill()</a> or <a href="Line+Color.html#stroke()">stroke()</a>
            command. You can use it to set the PDF background to transparent by supplying None as
            parameter (so it imports more easily in Photoshop or Illustrator).
          </div>

          <h2>Returns</h2>

          <div class="row">
            <a href="Line+Color.html#Color">Color</a> containing the defined color values<a href="Line+Color.html#Color"></a>
          </div>

          <h2>Tutorial</h2>

          <div class="row">
            <a href="../lib/Colors.html">Colors</a>
          </div>

          <h2>Example</h2>

          <div class="row">
            <table border="0">
              <tbody>
                <tr>
                  <td><span class="image_border"><img height="120" src="../etc/ref/background.gif" width="120"/></span>
                  </td><td>
<pre>
<span class="nf">background</span>(<span class="bp">None</span>)
<span class="nf">rect</span>(<span class="mi">10</span>, <span class="mi">10</span>, <span class="mi">50</span>, <span class="mi">50</span>)
</pre>
                  </td></tr></tbody></table>
          </div>
        </div>
      </div><a name="canvas()"></a>

      <div class="section">
        <h3>canvas</h3>

        <div class="definition">
          <h2>Object Description</h2>

          <div class="row">
            The <code>canvas</code> object accumulates a list of graphic objects as a side effect
            of calls to the various plotdevice drawing commands. It can save the image to an output
            file and can clear itself if you have more drawing to do.
          </div>

          <h2>Properties</h2>

          <div class="row">
<pre>
<span class="nf">canvas</span><span class="o">.</span><span class="nf">size</span>   <span class="c"># returns (w, h) based on prior call to size()</span>
<span class="nf">canvas</span><span class="o">.</span>_grobs <span class="c"># list of objects to be called when canvas.save() is called</span>
</pre>
          </div>

          <h2>Methods</h2>

          <div class="row">
<pre>
<span class="nf">canvas</span><span class="o">.</span>clear()        <span class="c"># erases all objects on the canvas and resets drawing state</span>
<span class="nf">canvas</span><span class="o">.</span><span class="nf">save</span>(filename) <span class="c"># name must end with pdf, eps, png, tiff, jpg, gif, or mov</span>
</pre>
          </div>
        </div>
      </div><a name="export()"></a>

      <div class="section">
        <h3>export()</h3>

        <div class="definition">
          <p class="pink_text">The <code>export</code> function is only of use to scripts that are
          using PlotDevice externally via a <code><a href="../tut/Scripting.html#plotdevice.script">from plotdevice.script import *</a></code>
          line. For scripts run within the application, use the Export as… commands in the file
          menu. Exports can also be batched using the <a href="../tut/plotdevice.html"><code>plotdevice</code></a> command.</p>
          <h2>Generating output from external scripts</h2>

          <p>The <code>export</code> function returns a <a href="http://docs.python.org/2/reference/compound_stmts.html#the-with-statement">context
          manager</a> that takes care of canvas-setup and file-generation for both single images
          and animations. By enclosing your drawing code in a <code>with</code> block, you can
          ensure that the correct sequence of <code>clear</code> and <code>save</code> calls are
          made to the <code><a href="#canvas">canvas</a></code> automatically. For instance these
          two methods of generating a png are equivalent:</p>
<pre>
<span class="kn">from</span> <span class="nn">plotdevice.script</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># export an image</span>
<span class="nf">canvas</span><span class="o">.</span>clear()
<span class="o">...</span> <span class="c"># (do some drawing)</span>
<span class="nf">canvas</span><span class="o">.</span><span class="nf">save</span>(<span class="s">'output.png'</span>)

<span class="c"># export an image</span>
<span class="c"># (with the context manager clearing and saving the canvas automatically)</span>
<span class="k">with</span> <span class="nf">export</span>(<span class="s">'output.png'</span>) <span class="k">as</span> <span class="nf">image</span>:
    <span class="o">...</span> <span class="c"># (do some drawing)</span>
</pre>

          <h2><a class="anchor" href="#animations" id="animations" name="animations"></a>Animations</h2>

          <p>If you specify a filename ending in <code>mov</code> (or <code>gif</code> if you also
          pass a <code>loop</code> or <code>fps</code> argument), the <code>export</code> context
          manager will return a <code>Movie</code> object. Each time you call its <code>add</code>
          method, a new frame with the contents of the canvas will be added to the end of the
          animation. Once you’ve added the final frame, you must call <code>finish</code> to wait
          for the video encoder thread to complete its work.</p>
          <p>As with the single-image version of the <code>export</code> call, you can use the
          <code>with</code> statement in your code to tidy up some of the frame-drawing
          boilerplate. All three examples are equivalent (note the use of a nested
          <code>with</code> statement in the final example):</p>
<pre>
<span class="c"># export a 100-frame movie</span>
movie <span class="o">=</span> <span class="nf">export</span>(<span class="s">'anim.mov'</span>, fps<span class="o">=</span><span class="mi">50</span>, bitrate<span class="o">=</span><span class="mf">1.8</span>)
<span class="k">for</span> i <span class="ow">in</span> <span class="nb">xrange</span>(<span class="mi">100</span>):
    <span class="nf">canvas</span><span class="o">.</span>clear() <span class="c"># erase the previous frame from the canvas</span>
    <span class="o">...</span>            <span class="c"># (do some drawing)</span>
    movie<span class="o">.</span>add()    <span class="c"># add the canvas to the movie</span>
movie<span class="o">.</span>finish()     <span class="c"># wait for i/o to complete</span>

<span class="c"># export a movie (with the context manager closing the file when done)</span>
<span class="k">with</span> <span class="nf">export</span>(<span class="s">'anim.mov'</span>, fps<span class="o">=</span><span class="mi">50</span>, bitrate<span class="o">=</span><span class="mf">1.8</span>) <span class="k">as</span> movie:
    <span class="k">for</span> i <span class="ow">in</span> <span class="nb">xrange</span>(<span class="mi">100</span>):
        <span class="nf">canvas</span><span class="o">.</span>clear() <span class="c"># erase the previous frame from the canvas</span>
        <span class="o">...</span>            <span class="c"># (do some drawing)</span>
        movie<span class="o">.</span>add()    <span class="c"># add the canvas to the movie</span>

<span class="c"># export a movie</span>
<span class="c"># (with the movie.frame context manager clearing and adding the frame)</span>
<span class="k">with</span> <span class="nf">export</span>(<span class="s">'anim.mov'</span>, fps<span class="o">=</span><span class="mi">50</span>, bitrate<span class="o">=</span><span class="mf">1.8</span>) <span class="k">as</span> movie:
    <span class="k">for</span> i <span class="ow">in</span> <span class="nb">xrange</span>(<span class="mi">100</span>):
        <span class="k">with</span> movie<span class="o">.</span>frame:
            <span class="o">...</span> <span class="c"># draw the next frame</span>
</pre>

          <h2><a class="anchor" href="#multi-page-pdfs" id="multi-page-pdfs" name="multi-page-pdfs"></a>Multi-page PDFs</h2>

          <p>Creating PDF documents works the same way, letting you either manually
          <code>clear</code>, <code>add</code> and <code>finish</code> the export or take advantage
          of the <code>with</code> statement to hide the repetitive bits. Note that PDF exports use
          the <code>page</code> attribute rather than <code>frame</code>:</p>
<pre>
<span class="c"># export a five-page pdf document</span>
pdf <span class="o">=</span> <span class="nf">export</span>(<span class="s">'multipage.pdf'</span>)
<span class="k">for</span> i <span class="ow">in</span> <span class="nb">xrange</span>(<span class="mi">5</span>):
    <span class="nf">canvas</span><span class="o">.</span>clear() <span class="c"># erase the previous page's graphics from the canvas</span>
    <span class="o">...</span>            <span class="c"># (do some drawing)</span>
    pdf<span class="o">.</span>add()      <span class="c"># add the canvas to the pdf as a new page</span>
pdf<span class="o">.</span>finish()       <span class="c"># write the pdf document to disk</span>

<span class="c"># export a pdf document more succinctly</span>
<span class="k">with</span> <span class="nf">export</span>(<span class="s">'multipage.pdf'</span>) <span class="k">as</span> pdf:
    <span class="k">for</span> i <span class="ow">in</span> <span class="nb">xrange</span>(<span class="mi">5</span>):
        <span class="k">with</span> pdf<span class="o">.</span>page:
            <span class="o">...</span> <span class="c"># draw the next page</span>
</pre>

          <h2><a class="anchor" href="#image-sequences" id="image-sequences" name="image-sequences"></a>Image sequences</h2>

          <p>If you’re generating a series of images, <code>export</code> will automatically give
          them consecutive names derived from the filename you pass as an argument. If the filename
          is a simple <code class="str">’name.ext’</code> string, the sequence number will be
          appended with 4 characters of padding (<code class="str">’name-0001.ext’</code>,
          <code class="str">’name-0002.ext’</code>, etc.). If the filename contains a block of
          <code>###</code> characters, they will be replaced with the sequence number and zero
          padded to the same width:</p>
<pre>
<span class="c"># export a sequence of images to output-0001.png, output-0002.png, ...</span>
<span class="c">#                                output-0099.png, output-0100.png</span>
<span class="k">with</span> <span class="nf">export</span>(<span class="s">'output.png'</span>) <span class="k">as</span> <span class="nf">image</span>:
    <span class="k">for</span> i <span class="ow">in</span> <span class="nb">xrange</span>(<span class="mi">100</span>):
        <span class="k">with</span> <span class="nf">image</span><span class="o">.</span>sequence:
            <span class="o">...</span> <span class="c"># draw the next image in the sequence</span>

<span class="c"># export a sequence of images to 01-img.png, 02-img.png, ...</span>
<span class="c">#                                99-img.png, 100-img.png</span>
<span class="k">with</span> <span class="nf">export</span>(<span class="s">'##-img.png'</span>) <span class="k">as</span> <span class="nf">image</span>:
    <span class="k">for</span> i <span class="ow">in</span> <span class="nb">xrange</span>(<span class="mi">100</span>):
        <span class="k">with</span> <span class="nf">image</span><span class="o">.</span>sequence:
            <span class="o">...</span> <span class="c"># draw the next image in the sequence</span>
</pre>
        </div>
      </div><a name="speed()"></a>

      <div class="section">
        <h3>speed()</h3>

        <div class="definition">
          <h2>Syntax</h2>

          <div class="row">
<pre>
<span class="nf">speed</span>(fps)
</pre>
          </div>

          <h2>Description</h2>

          <div class="row">
            <p>Using the speed() command causes your script to be interpreted as an animation. In
            an animation, your drawing code does not live in the top-level of the script, but
            instead is factored into a trio of methods defined in the script: <code>setup()</code>,
            <code>draw()</code>, and <code>stop()</code>. The <code>setup</code> method is called
            once at the beginning of a run, and <code>stop</code> is called once the run is halted.
            The <code>draw</code> method is called repeatedly with the canvas being cleared between
            calls. The global variable called <code class="kw">FRAME</code> will be incremented
            before every <code>draw</code> and can be used to track progress.</p>
            <p>The <code>fps</code> argument specifies the maximum speed of the animation in frames
            per second. Note that this is only a maximum and complex animations will likely update
            less frequently.</p>
          </div>

          <h2>Tutorial</h2>

          <div class="row">
            <a href="../tut/Animation.html">Animation</a>
          </div>

          <h2>Example</h2>

          <div class="row">
<pre>
<span class="nf">speed</span>(<span class="mi">30</span>)

<span class="k">def</span> <span class="nf">setup</span>(): <span class="c"># initialize variables, etc.</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">draw</span>(): <span class="c"># draw the next frame in the animation</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">stop</span>(): <span class="c"># gather up accumulated data, print summary info, etc.</span>
    <span class="k">pass</span>
</pre>
          </div>
        </div>
      </div>
    </div>

    <div class="types">
      <div class="classic">
        <p class="rose_text">Classes</p>
      </div><a id="Constants" name="Constants"></a>

      <div class="section">
        <h3>Constants</h3>

        <div class="definition">
          <h2>Named parameter values</h2>

          <div class="consts">
<pre>
<span class="kc">inch</span>, <span class="kc">cm</span>, <span class="kc">mm</span>
</pre>

            <p>scale factors used to set non-pixel dimensions with <a href="#size()"><code>size()</code></a></p>
          </div>

          <div class="consts">
<pre>
<span class="kc">pi</span>, <span class="kc">tau</span>
</pre>

            <p>trig quantities equal to a half- and full-circle respectively</p>
          </div>

          <div class="consts">
<pre>
<span class="kc">RGB</span>, <span class="kc">HSB</span>, <span class="kc">CMYK</span>
</pre>

            <p>color modes used by <a href="Line+Color.html#colormode()"><code>colormode()</code></a>, <a href="#outputmode()"><code>outputmode()</code></a>, and others</p>
          </div>

          <div class="consts">
<pre>
<span class="kc">CENTER</span>, <span class="kc">CORNER</span>
</pre>

            <p>transformation origins used by <a href="Transform.html#transform()"><code>transform()</code></a></p>
          </div>

          <div class="consts">
<pre>
<span class="kc">DEGREES</span>, <span class="kc">RADIANS</span>, <span class="kc">PERCENT</span>
</pre>

            <p>units understood by <a href="Transform.html#rotate()"><code>rotate()</code></a></p>
          </div>

          <div class="consts">
<pre>
<span class="kc">LEFT</span>, <span class="kc">RIGHT</span>, <span class="kc">CENTER</span>, <span class="kc">JUSTIFY</span>
</pre>

            <p>text alignment modes used by <a href="Typography.html#align()"><code>align()</code></a></p>
          </div>

          <div class="consts">
<pre>
<span class="kc">MOVETO</span>, <span class="kc">LINETO</span>, <span class="kc">CURVETO</span>, <span class="kc">CLOSE</span>
</pre>

            <p>types of <a href="Drawing.html#PathElement"><code>PathElement</code></a></p>
          </div>

          <div class="consts">
<pre>
<span class="kc">MITER</span>, <span class="kc">ROUND</span>, <span class="kc">BEVEL</span>
</pre>

            <p>path vertex styles set by <a href="Line+Color.html#joinstyle()"><code>joinstyle()</code></a></p>
          </div>

          <div class="consts">
<pre>
<span class="kc">BUTT</span>, <span class="kc">ROUND</span>, <span class="kc">SQUARE</span>
</pre>

            <p>path endpoint styles set by <a href="Line+Color.html#capstyle()"><code>capstyle()</code></a></p>
          </div>

          <div class="consts">
<pre>
<span class="kc">NORMAL</span>, <span class="kc">FORTYFIVE</span>
</pre>

            <p>styles for the <a href="Primitives.html#arrow()"><code>arrow()</code></a> primitive</p>
          </div>

          <div class="consts">
<pre>
<span class="kc">NUMBER</span>, <span class="kc">TEXT</span>, <span class="kc">BOOLEAN</span>, <span class="kc">BUTTON</span>
</pre>

            <p>datatypes for specifying a dynamic <a href="Utility.html#var()"><code>var()</code></a></p>
          </div>

          <h2>Global state</h2>

          <div class="consts">
<pre>
<span class="kc">WIDTH</span>, <span class="kc">HEIGHT</span>
</pre>

            <p>the current size of the canvas in the wake of the most recent <a href="#size()"><code>size()</code></a> call</p>
          </div>

          <div class="consts">
<pre>
<span class="kc">FRAME</span>, <span class="kc">PAGE</span>
</pre>

            <p>the current iteration count in an <a href="../tut/Animation.html">animation</a>
            (note that these are synonyms for the same value, counting up from 1)</p>
          </div>

          <div class="consts">
<pre>MOUSEX, MOUSEY, mousedown
</pre>

            <p>mouse events</p>
          </div>

          <div class="consts">
<pre>
<span class="kc">KEY_UP</span>, <span class="kc">KEY_DOWN</span>, <span class="kc">KEY_LEFT</span>, <span class="kc">KEY_RIGHT</span>, <span class="kc">KEY_BACKSPACE</span>, <span class="kc">KEY_TAB</span>, <span class="kc">KEY_ESC</span>
</pre>

            <p>keyboard events</p>
          </div>
        </div>
      </div>
    </div>

    <div class="compat">
      <div class="classic">
        <p class="pink_text">NodeBox Compatibility</p>
        <p><em>Though their functionality has been subsumed by the commands listed above, the
        following NodeBox Setup commands may also be used in your scripts.</em></p>
      </div><a name="outputmode()"></a>

      <div class="section">
        <h3>outputmode()</h3>

        <div class="definition">
          <h2>Syntax</h2>

          <div class="row">
<pre>
<span class="nf">outputmode</span>(mode)
</pre>
          </div>

          <h2>Description</h2>

          <div class="row">
            Changes the way colors are displayed. While the <a href="Line+Color.html#colormode()">colormode()</a> command specifies the input of colors,
            outpumode() specifies the output. By default, the output mode for colors is RGB, but
            you can also set it to CMYK so that exported PDF’s are ready for print. Output in RGB
            will look brighter on screen but to validate PDF documents the colors need to be in
            CMYK.
          </div>

          <h2>Returns</h2>

          <div class="row">
            the current output mode (RGB or CMYK)
          </div>

          <h2>Tutorial</h2>

          <div class="row">
            <a href="../lib/Colors.html">Colors</a>
          </div>

          <h2>Example</h2>

          <div class="row">
<pre>
<span class="nf">outputmode</span>(<span class="kc">CMYK</span>)
</pre>
          </div>
        </div>
      </div><a name="size()"></a>

      <div class="section">
        <h3>size()</h3>

        <div class="definition">
          <h2>Syntax</h2>

          <div class="row">
<pre>
<span class="nf">size</span>(w, h)
</pre>
          </div>

          <h2>Description</h2>

          <div class="row">
            Sets the size of the canvas in points. The first parameter sets the width, the second
            parameter the height. If this command is used, it should be the first line in a script
            - it’s illogical to set the size of the canvas halfway a script! The supplied values
            can be multiplied by ‘inch’, ‘cm’ or ‘mm’. The predefined WIDTH and HEIGHT variables
            can be used to obtain the canvas size.
          </div>

          <h2>Tutorial</h2>

          <div class="row">
            <a href="../tut/Variables.html">Variables</a>
          </div>

          <h2>Example</h2>

          <div class="row">
            <table border="0">
              <tbody>
                <tr>
                  <td>
<pre>
<span class="nf">size</span>(<span class="mi">400</span>, <span class="mi">600</span>)
<span class="c"># the canvas is 400 X 600 points</span>
<span class="k">print</span> <span class="kc">WIDTH</span> <span class="c"># prints 400</span>
<span class="k">print</span> <span class="kc">HEIGHT</span> <span class="c"># prints 600</span>
</pre>
<pre>
<span class="nf">size</span>(<span class="mi">20</span><span class="o">*</span><span class="kc">cm</span>, <span class="mi">20</span><span class="o">*</span><span class="kc">cm</span>)
<span class="c"># the canvas is 20 x 20 cm</span>
</pre>
                  </td></tr></tbody></table>
          </div>
        </div>
      </div>
    </div>
  </div>

</body></html>