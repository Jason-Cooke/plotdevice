<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>

  <title>PlotDevice Tutorials: Math</title>
  <link charset="utf-8" href="../etc/manual.css" rel="stylesheet" type="text/css"/>

</head><body>
  <div class="link" id="nav">
    <h1><a href="../manual.html">Plot Device <span>Tutorials</span></a></h1>

    <h3>Math</h3>

    <ul class="chapter">
      <li><a href="Extending.html">Extending →</a></li>
      <li>Chapter 16</li>
      <li><a href="Color.html">← Color</a></li>
    </ul>
  </div>

  <div class="article">
    <p>More often than not programming scripts in PlotDevice involves a little bit of mathematics.
    Things like fluid motion, orbitting behavior and easing in and out all require math formulas.
    Since most of us probably weren’t paying any attention during math class, this document
    explains some useful math techniques.<a id="Geometry" name="Geometry"></a></p>
    <div class="section">
      <h3>Geometry</h3>

      <p>Sometimes you have the location of two points and you want to know the angle between them.
      Or the distance. Or you have the coordinates of one point and want to know the location of
      the second point based on an angle and a distance. The following math commands might be of
      help. You can also find the basics about sines and cosines <a href="#Trigonometry">below</a>.<br/></p>
      <p>The angle between two points:</p>
<pre>
<span class="k">def</span> <span class="nf">angle</span>(x0, y0, x1, y1):
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> degrees, atan2
    a <span class="o">=</span> degrees( atan2(y1<span class="o">-</span>y0, x1<span class="o">-</span>x0) )
    <span class="k">return</span> a
</pre>

      <p>The distance between two points:</p>
<pre>
<span class="k">def</span> <span class="nf">distance</span>(x0, y0, x1, y1):
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> sqrt, <span class="nb">pow</span>
    <span class="k">return</span> sqrt(<span class="nb">pow</span>(x1<span class="o">-</span>x0, <span class="mi">2</span>) <span class="o">+</span> <span class="nb">pow</span>(y1<span class="o">-</span>y0, <span class="mi">2</span>))
</pre>

      <p>The location of a point based on angle and distance:</p>
<pre>
<span class="k">def</span> <span class="nf">coordinates</span>(x0, y0, distance, angle):
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> radians, sin, cos
    x1 <span class="o">=</span> x0 <span class="o">+</span> cos(radians(angle)) <span class="o">*</span> distance
    y1 <span class="o">=</span> y0 <span class="o">+</span> sin(radians(angle)) <span class="o">*</span> distance
    <span class="k">return</span> x1, y1
</pre>

      <p>The reflection of a point through an origin point:</p>
<pre>
<span class="k">def</span> <span class="nf">reflect</span>(x0, y0, x1, y1, d<span class="o">=</span><span class="mf">1.0</span>, a<span class="o">=</span><span class="mi">180</span>):
    d <span class="o">*=</span> distance(x0, y0, x1, y1)
    a <span class="o">+=</span> angle(x0, y0, x1, y1)
    x, y <span class="o">=</span> coordinates(x0, y0, d, a)
    <span class="k">return</span> x, y
</pre>

      <p>To use fast, C-based versions of these commands in your script, they can be accessed
      through the <code class="kw">geo</code> global:</p>
<pre>geo<span class="o">.</span>angle(x0, y0, x1, y1)
geo<span class="o">.</span>distance(x0, y0, x1, y1)
geo<span class="o">.</span>coordinates(x0, y0, distance, angle)
geo<span class="o">.</span>reflect(x0, y0, x1, y1, d<span class="o">=</span><span class="mf">1.0</span>, a<span class="o">=</span><span class="mi">180</span>)
</pre>

      <p>Or you can simply import them:</p>
<pre>
<span class="kn">from</span> <span class="nn">plotdevice.geo</span> <span class="kn">import</span> angle, distance, coordinates, reflect
</pre> 

      <p>Some examples:</p>
      <table border="0">
        <tbody>
          <tr>
            <td><img alt="math-angle" height="260" src="../etc/tut/math-angle.jpg" width="260"/>
            </td><td>
              <p>The direction from the center of random points.</p>
<pre>x0, y0, r <span class="o">=</span> <span class="kc">WIDTH</span><span class="o">/</span><span class="mi">2</span>, <span class="kc">HEIGHT</span><span class="o">/</span><span class="mi">2</span>, <span class="mi">2</span>
 
<span class="k">for</span> i <span class="ow">in</span> <span class="nb">range</span>(<span class="mi">5</span>):
    x1 <span class="o">=</span> <span class="nf">random</span>(<span class="kc">WIDTH</span>)
    y1 <span class="o">=</span> <span class="nf">random</span>(<span class="kc">HEIGHT</span>)
    <span class="nf">oval</span>(x1<span class="o">-</span>r, y1<span class="o">-</span>r, r<span class="o">*</span><span class="mi">2</span>, r<span class="o">*</span><span class="mi">2</span>)
    a <span class="o">=</span> angle(x0, y0, x1, y1)
    <span class="nf">transform</span>(<span class="kc">CORNER</span>)
    <span class="nf">translate</span>(x0, y0)
    <span class="nf">rotate</span>(<span class="o">-</span>a)
    <span class="nf">arrow</span>(<span class="mi">30</span>, <span class="mi">0</span>, <span class="mi">10</span>)
    <span class="nf">reset</span>()
</pre>
          </td></tr><tr>
            <td><img alt="math-coordinates" height="260" src="../etc/tut/math-coordinates.jpg" width="260"/>
            </td><td>
              <p>Orbiting around(x0, y0).</p>
<pre>x0, y0, r <span class="o">=</span> <span class="kc">WIDTH</span><span class="o">/</span><span class="mi">2</span>, <span class="kc">HEIGHT</span><span class="o">/</span><span class="mi">2</span>, <span class="mi">2</span>
<span class="nf">oval</span>(x0<span class="o">-</span>r, y0<span class="o">-</span>r, r<span class="o">*</span><span class="mi">2</span>, r<span class="o">*</span><span class="mi">2</span>)
 
<span class="k">for</span> i <span class="ow">in</span> <span class="nb">range</span>(<span class="mi">10</span>):
    a <span class="o">=</span> <span class="mi">36</span><span class="o">*</span>i
    x1, y1 <span class="o">=</span> coordinates(x0, y0, <span class="mi">85</span>, a)
    <span class="nf">oval</span>(x1<span class="o">-</span>r, y1<span class="o">-</span>r, r<span class="o">*</span><span class="mi">2</span>, r<span class="o">*</span><span class="mi">2</span>)
    <span class="nf">line</span>(x0, y0, x1, y1)
</pre>
          </td></tr><tr>
            <td><img alt="math-perpendicular" height="260" src="../etc/tut/math-perpendicular.jpg" width="260"/>
            </td><td>
              <p>Perpendicular lines on a circle path:<br/>
              angle between a point and its handle - 90 degrees.</p>
<pre>path <span class="o">=</span> <span class="nf">oval</span>(<span class="mi">100</span>, <span class="mi">100</span>, <span class="mi">105</span>, <span class="mi">105</span>)
<span class="k">for</span> t <span class="ow">in</span> <span class="nb">range</span>(<span class="mi">50</span>):
    pt <span class="o">=</span> path<span class="o">.</span>point(<span class="nb">float</span>(t) <span class="o">/</span> <span class="mi">50</span>)
    a <span class="o">=</span> angle(pt<span class="o">.</span>x, pt<span class="o">.</span>y, 
        pt<span class="o">.</span>ctrl2<span class="o">.</span>x, pt<span class="o">.</span>ctrl2<span class="o">.</span>y)
    <span class="nf">transform</span>(<span class="kc">CORNER</span>)
    <span class="nf">push</span>()
    <span class="nf">translate</span>(pt<span class="o">.</span>x, pt<span class="o">.</span>y)
    <span class="nf">rotate</span>(<span class="o">-</span>a<span class="o">+</span><span class="mi">90</span>)
    <span class="nf">line</span>(<span class="mi">0</span>, <span class="mi">0</span>, <span class="mi">35</span>, <span class="mi">0</span>)
    <span class="nf">pop</span>()
</pre>
            </td></tr></tbody></table><br/>

      <p> </p>
    </div><a id="Sequences" name="Sequences"></a>

    <div class="section">
      <h3>Sequences</h3>

      <p>Sometimes you want to give a position and/or size to objects in such a way that they
      interrelate to each other, that there is some kind of ordering or harmony between them. Sine
      waves for example are great to describe motion because they ease in and out. Another
      interesting proportional principle is the <i>golden ratio</i>, the 3-5-8 rule. It has been
      around in aesthetics for a long long time. The great thing about it is that it can be
      expressed as a mathematical series (Fibonacci sequence).</p>
<pre>
<span class="k">def</span> <span class="nf">fib</span>(n):
    <span class="k">if</span> n <span class="o">==</span> <span class="mi">0</span>: <span class="k">return</span> <span class="mi">0</span>
    <span class="k">if</span> n <span class="o">==</span> <span class="mi">1</span>: <span class="k">return</span> <span class="mi">1</span>
    <span class="k">if</span> n <span class="o">&gt;=</span> <span class="mi">2</span>: <span class="k">return</span> fib(n<span class="o">-</span><span class="mi">1</span>) <span class="o">+</span> fib(n<span class="o">-</span><span class="mi">2</span>)
 
<span class="k">def</span> <span class="nf">goldenratio</span>(n, f<span class="o">=</span><span class="mi">4</span>):
    <span class="c"># Returns two proportional numbers whose sum is n.</span>
    f <span class="o">=</span> <span class="nb">max</span>(<span class="mi">1</span>, <span class="nb">min</span>(f, <span class="mi">10</span>))
    n <span class="o">/=</span> <span class="nb">float</span>(fib(f<span class="o">+</span><span class="mi">2</span>))
    <span class="k">return</span> n<span class="o">*</span>fib(f<span class="o">+</span><span class="mi">1</span>), n<span class="o">*</span>fib(f)
</pre> 

      <p>Colored rectangles proportioned with the golden ratio:</p>
      <table border="0">
        <tbody>
          <tr>
            <td><img alt="math-fib1" height="260" src="../etc/tut/math-fib1.jpg" width="260"/>
            </td><td>
<pre>w1, w2 <span class="o">=</span> goldenratio(<span class="mi">260</span>)
h1, h2 <span class="o">=</span> goldenratio(<span class="mi">260</span>)
b1, b2 <span class="o">=</span> goldenratio(<span class="mf">1.0</span>)
b3, b4 <span class="o">=</span> goldenratio(b1)
 
<span class="nf">fill</span>(<span class="mi">0</span>, b1<span class="o">/</span><span class="mi">2</span>, b1)
<span class="nf">rect</span>(<span class="mi">0</span>, <span class="mi">0</span>, w1, h1)
 
<span class="nf">fill</span>(<span class="mi">0</span>, b2<span class="o">/</span><span class="mi">2</span>, b2)
<span class="nf">rect</span>(w1, <span class="mi">0</span>, w2, h1)
 
<span class="nf">fill</span>(<span class="mi">0</span>, b4<span class="o">/</span><span class="mi">2</span>, b4)
<span class="nf">rect</span>(<span class="mi">0</span>, h1, w1<span class="o">+</span>w2, h2)
</pre>
          </td></tr><tr>
            <td><img alt="math-fib2" height="260" src="../etc/tut/math-fib2.jpg" width="260"/>
            </td><td>
<pre>x, y <span class="o">=</span> <span class="mi">0</span>, <span class="mi">0</span>
w, h <span class="o">=</span> <span class="mi">260</span>, <span class="mi">260</span>
 
th <span class="o">=</span> h <span class="c"># top height</span>
bh <span class="o">=</span> <span class="mi">0</span> <span class="c"># bottom height</span>
<span class="k">for</span> i <span class="ow">in</span> <span class="nb">range</span>(<span class="mi">10</span>):
    th, bh <span class="o">=</span> goldenratio(th)
    v <span class="o">=</span> <span class="nb">float</span>(th)<span class="o">/</span>w <span class="o">+</span> <span class="mf">0.3</span>
    <span class="nf">fill</span>(<span class="mi">0</span>, v<span class="o">/</span><span class="mi">2</span>, v)
    <span class="nf">rect</span>(x, y, w, th)
    y <span class="o">+=</span> th
    th <span class="o">=</span> bh
</pre>
            </td></tr></tbody></table>

      <p> </p>
    </div><a id="Trigonometry" name="Trigonometry"></a>

    <div class="section">
      <h3>Trigonometry</h3>

      <p><span class="big_text">A sine calculates the vertical offset between two points based on
      the angle. A cosine calculates the horizontal distance.</span></p>
      <p> </p>
      <table border="0">
        <tbody>
          <tr>
            <td><img alt="math-trig1" height="260" src="../etc/tut/math-trig1.jpg" width="260"/>
            </td><td>
              <p>Let’s say we have two points, <em>a</em> and <em>b</em>, connected by a line.</p>
          </td></tr><tr>
            <td><img alt="math-trig2" height="260" src="../etc/tut/math-trig2.jpg" width="260"/>
            </td><td>
              <p>Now let’s assume <em>a</em> is at the origin (or center) of a circle. The circle
              has a radius equal to the length of the line connecting <em>a</em> and <em>b</em>.</p>
              <p>So <em>b</em> is located somewhere on the circle’s circumference.</p>
          </td></tr><tr>
            <td><img alt="math-trig3" height="260" src="../etc/tut/math-trig3.jpg" width="260"/>
            </td><td>
              <p>There is a horizontal and vertical distance between <em>a</em> and <em>b</em>.</p>
              <p>We can use <em>sine</em> and <em>cosine</em> to determine those distances.</p>
          </td></tr><tr>
            <td><img alt="math-trig4" height="260" src="../etc/tut/math-trig4.jpg" width="260"/>
            </td><td>
              <p>Each line from <em>a</em> to a point on the circle’s circumference (for example,
              <em>b</em>) has an angle.</p>
              <p>Measured counterclockwise, starting from 0°, a circle has a total circumference of
              360°. So a line from <em>a</em> going straight up would have an angle of 90°.</p>
              <p>In the case of the line between <em>a</em> and <em>b</em>, the angle is 60°.</p>
          </td></tr><tr>
            <td><img alt="math-trig5" height="260" src="../etc/tut/math-trig5.jpg" width="260"/>
            </td><td>
              <p>The cosine function calculates the <strong>horizontal</strong> distance between
              <em>a</em> and <em>b</em> based on the angle.</p>
              <p>The sine function calculates the <strong>vertical</strong> distance between
              <em>a</em> and <em>b</em>.</p>
              <p>In the case of an angle of 60°, the sine yields 0.5. So the horizontal distance
              between <em>a</em> and <em>b</em> is half the length of the line between <em>a</em>
              and <em>b</em>.</p>
          </td></tr><tr>
            <td><img alt="math-trig6" height="260" src="../etc/tut/math-trig6.jpg" width="260"/>
            </td><td>
              <p>With sine and cosine we can calculate the distance between <em>a</em> and
              <em>b</em>.</p>
              <p>This is useful if we have position coordinates for <em>a</em> and we need to
              calculate the position of a point <em>b</em> that is orbiting around it.</p>
              <p>For 60°, the sine yields 0.5, meaning half the length of the distance between
              <em>a</em> and <em>b</em>. So the horizontal distance between <em>a</em> and
              <em>b</em> is 70 * 0.5 = 35.</p>
              <p>So <em>b</em>’s x equals <em>a</em>’s x plus 35.<br/></p>
          </td></tr><tr>
            <td><img alt="math-trig7" height="260" src="../etc/tut/math-trig7.jpg" width="260"/>
            </td><td>
              <p>The command in PlotDevice would look like this:</p>
<pre>
<span class="k">def</span> <span class="nf">coordinates</span>(x0, y0, distance, angle):
    <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> radians, sin, cos
    angle <span class="o">=</span> radians(angle)
    x1 <span class="o">=</span> x0 <span class="o">+</span> cos(angle) <span class="o">*</span> distance
    y1 <span class="o">=</span> y0 <span class="o">+</span> sin(angle) <span class="o">*</span> distance
    <span class="k">return</span> x1, y1
</pre> 
            </td></tr></tbody></table>
    </div>
  </div>

</body></html>