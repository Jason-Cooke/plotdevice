<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>

  <title>PlotDevice Tutorials: Tendrils</title>
  <link charset="utf-8" href="../etc/manual.css" rel="stylesheet" type="text/css"/>

</head><body>
  <div class="link" id="nav">
    <h1><a href="../manual.html">Plot Device <span>Tutorials</span></a></h1>

    <h3>Tendrils</h3>
  </div>

  <div class="article">
    <p><span class="big_text">I had some code lying around which I thought I’d share with you. It
    is an adaption of a Processing algorithm by <a href="http://www.artcom.de/process/">ART+COM</a>, visualizing an elegant growing plant.</span></p>
    <p>The source code has been organized in two simple classes so it might help you when learning
    from the <a href="Classes.html">tutorial on classes</a>. The first class, <i>Tendril</i>,
    defines a single branch in the plant. As it grows it calculates the position of new segments by
    steering its current heading a bit to the left or right, hence the spiraling shape. The second
    class, <i>Plant</i>, defines a group of tendrils. It has some simple methods to grow and draw
    all the tendrils together.</p>
    <p> </p>
    <p><img alt="tendrils1" height="550" src="../etc/tut/tendrils1.jpg" width="550"/></p>
<pre>
<span class="nf">size</span>(<span class="mi">600</span>, <span class="mi">600</span>)
 
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="kc">pi</span>, sin, cos, radians
 
<span class="k">class</span> <span class="nc">Tendril</span>:
    
    <span class="k">def</span> <span class="nf">__init__</span>(<span class="bp">self</span>, x, y, width<span class="o">=</span><span class="mi">15</span>):
        <span class="sd">""" A new sinewy tendril at location x and y.</span>
<span class="sd">        Its segment width will gradually become smaller as it grows.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span>x <span class="o">=</span> x
        <span class="bp">self</span><span class="o">.</span>y <span class="o">=</span> y
        <span class="bp">self</span><span class="o">.</span>width <span class="o">=</span> width
        <span class="bp">self</span><span class="o">.</span>angle <span class="o">=</span> <span class="nf">random</span>(<span class="mi">2</span><span class="o">*</span><span class="kc">pi</span>) <span class="o">-</span> <span class="kc">pi</span> <span class="c"># random angle in radians.</span>
        <span class="bp">self</span><span class="o">.</span>segments <span class="o">=</span> []
        <span class="bp">self</span><span class="o">.</span>v <span class="o">=</span> <span class="mi">0</span>
 
    <span class="k">def</span> <span class="nf">grow</span>(<span class="bp">self</span>, distance<span class="o">=</span><span class="mf">3.0</span>, curl<span class="o">=</span><span class="mf">1.0</span>, step<span class="o">=</span><span class="mf">0.02</span>):
        <span class="sd">""" Tendril segment growth using fluid, spiral sine functions,</span>
<span class="sd">        taken from the ART+COM Tendrils class for Processing.</span>
<span class="sd">        """</span>
        <span class="c"># Think of a tendril having a steering compass.</span>
        <span class="c"># For each new segment, the compass shifts a bit left or right.</span>
        <span class="bp">self</span><span class="o">.</span>x <span class="o">+=</span> cos(<span class="bp">self</span><span class="o">.</span>angle) <span class="o">*</span> distance
        <span class="bp">self</span><span class="o">.</span>y <span class="o">+=</span> sin(<span class="bp">self</span><span class="o">.</span>angle) <span class="o">*</span> distance
        <span class="bp">self</span><span class="o">.</span>v <span class="o">+=</span> <span class="nf">random</span>(<span class="o">-</span>step, step)
        <span class="bp">self</span><span class="o">.</span>v <span class="o">*=</span> <span class="mf">0.9</span> <span class="o">+</span> curl<span class="o">*</span><span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span>angle <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span>v
        <span class="bp">self</span><span class="o">.</span>segments<span class="o">.</span>append(
            (<span class="bp">self</span><span class="o">.</span>x, <span class="bp">self</span><span class="o">.</span>y, <span class="bp">self</span><span class="o">.</span>angle)
        )
        
    <span class="k">def</span> <span class="nf">draw</span>(<span class="bp">self</span>, path<span class="o">=</span><span class="bp">None</span>):
        <span class="sd">""" Draws all the segments in the tendril,</span>
<span class="sd">        as separate ovals or as a single path if one is supplied.</span>
<span class="sd">        """</span>
        n <span class="o">=</span> <span class="nb">len</span>(<span class="bp">self</span><span class="o">.</span>segments)
        <span class="k">for</span> i, (x, y, angle) <span class="ow">in</span> <span class="nb">enumerate</span>(<span class="bp">self</span><span class="o">.</span>segments):
            r <span class="o">=</span> (<span class="mi">1</span><span class="o">-</span><span class="nb">float</span>(i)<span class="o">/</span>n) <span class="o">*</span> <span class="bp">self</span><span class="o">.</span>width <span class="c"># size gradually decreases.</span>
            <span class="k">if</span> path <span class="o">!=</span> <span class="bp">None</span>:
                path<span class="o">.</span><span class="nf">oval</span>(x, y, r, r)
            <span class="k">else</span>:
                <span class="nf">oval</span>(x, y, r, r)
        
<span class="k">class</span> <span class="nc">Plant</span>:
    
    <span class="k">def</span> <span class="nf">__init__</span>(<span class="bp">self</span>, x, y, tendrils<span class="o">=</span><span class="mi">30</span>, width<span class="o">=</span><span class="mi">15</span>):
        <span class="sd">""" A collection of tendrils.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span>x <span class="o">=</span> x
        <span class="bp">self</span><span class="o">.</span>y <span class="o">=</span> y
        <span class="bp">self</span><span class="o">.</span>tendrils <span class="o">=</span> []
        <span class="k">for</span> i <span class="ow">in</span> <span class="nb">range</span>(tendrils): 
            <span class="bp">self</span><span class="o">.</span>tendrils<span class="o">.</span>append(
                Tendril(<span class="bp">self</span><span class="o">.</span>x, <span class="bp">self</span><span class="o">.</span>y, width)
            )
    
    <span class="k">def</span> <span class="nf">grow</span>(<span class="bp">self</span>, distance<span class="o">=</span><span class="mf">3.0</span>, curl<span class="o">=</span><span class="mf">1.0</span>, step<span class="o">=</span><span class="mf">0.02</span>):
        <span class="sd">""" Grow a new segment on each of the plant's tendrils.</span>
<span class="sd">        """</span>
        <span class="k">for</span> b <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span>tendrils:
            b<span class="o">.</span>grow(distance, curl, step)
            
    <span class="k">def</span> <span class="nf">draw</span>(<span class="bp">self</span>):
        <span class="sd">""" Draw the plant.</span>
<span class="sd">        """</span>
        <span class="k">for</span> tendril <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span>tendrils:
            tendril<span class="o">.</span>draw()
        
    <span class="k">def</span> <span class="nf">path</span>(<span class="bp">self</span>):
        <span class="sd">""" Return the plant as a path consisting of ovals.</span>
<span class="sd">        """</span>
        path <span class="o">=</span> <span class="nc">BezierPath</span>()
        <span class="k">for</span> tendril <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span>tendrils:
            tendril<span class="o">.</span>draw(path)
        <span class="k">return</span> path
 
<span class="nf">background</span>(<span class="mf">0.12</span>, <span class="mf">0.12</span>, <span class="mf">0.06</span>)
<span class="nf">nofill</span>()
<span class="nf">stroke</span>(<span class="mi">1</span>, <span class="mf">0.5</span>)
<span class="nf">strokewidth</span>(<span class="mf">0.5</span>)
 
plant <span class="o">=</span> Plant(<span class="kc">WIDTH</span><span class="o">/</span><span class="mi">2</span>, <span class="kc">HEIGHT</span><span class="o">/</span><span class="mi">2</span>, tendrils<span class="o">=</span><span class="mi">20</span>)
<span class="k">for</span> i <span class="ow">in</span> <span class="nb">range</span>(<span class="mi">200</span>): 
    plant<span class="o">.</span>grow(curl<span class="o">=</span><span class="mf">1.0</span>, step<span class="o">=</span><span class="mf">0.02</span>)
 
plant<span class="o">.</span>draw()
</pre> 
    <hr size="2" width="100%"/>

    <h2>Using the plant as a layer in Core Image</h2>

    <p>With a simple adaption we can use the <i>plant.path()</i> method as input for <a href="../lib/Core_Image.html">Core Image</a>. This way we can transform the plant shape as a layer
    of pixel data. Simply add the lines of code below the image to the bottom of the script, and
    play around with the <i>curl</i> parameter a bit.</p>
    <p> </p>
    <p><img alt="tendrils2" height="550" src="../etc/tut/tendrils2.jpg" width="550"/></p>
<pre>coreimage <span class="o">=</span> <span class="nf">ximport</span>(<span class="s">"coreimage"</span>)
<span class="nf">canvas</span> <span class="o">=</span> coreimage<span class="o">.</span><span class="nf">canvas</span>(<span class="kc">WIDTH</span>, <span class="kc">HEIGHT</span>)
layer <span class="o">=</span> <span class="nf">canvas</span><span class="o">.</span>append(
    plant<span class="o">.</span>path(), 
    <span class="nf">fill</span><span class="o">=</span><span class="nf">color</span>(<span class="mi">1</span>,<span class="mi">0</span>), 
    <span class="nf">stroke</span><span class="o">=</span><span class="nf">color</span>(<span class="mi">1</span>,<span class="mf">0.8</span>), 
    <span class="nf">strokewidth</span><span class="o">=</span><span class="mf">0.2</span>
)
layer<span class="o">.</span>filter(<span class="s">"zoomblur"</span>, amount<span class="o">=</span><span class="mi">10</span>)
<span class="nf">canvas</span><span class="o">.</span>draw()
</pre> 

    <p>Created by Tom De Smedt<br/>
    Based on the ‘Tendrils’ algorithm by ART+COM<br/></p>
  </div>

</body></html>